package com.GASB.anti_malware.service;

import com.GASB.anti_malware.controller.dto.VtReportDto;
import com.GASB.anti_malware.domain.VtReport;
import com.GASB.anti_malware.repository.VtReportRepository;
import org.springframework.stereotype.Service;

@Service
public class VtReportReturnService {
    private final VtReportRepository vtReportRepository;

    public VtReportReturnService(VtReportRepository vtReportRepository) {
        this.vtReportRepository = vtReportRepository;
    }

    public VtReport getReportById(long file_id){
        return vtReportRepository.findById(file_id).orElse(null);
    }

    public VtReportDto convertToDto(VtReport report) {
        if (report == null) {
            return null;
        }
        return VtReportDto.builder()
                .fileId(report.getFile_id())
                .type(report.getType())
                .v3(report.getV3())
                .alyac(report.getALYac())
                .kaspersky(report.getKaspersky())
                .falcon(report.getFalcon())
                .avast(report.getAvast())
                .sentinelone(report.getSentinelone())
                .detectEngine(report.getDetect_engine())
                .completeEngine(report.getComplete_engine())
                .score(report.getScore())
                .threatLabel(report.getThreat_label())
                .reportUrl(report.getReport_url())
                .build();
    }
}
