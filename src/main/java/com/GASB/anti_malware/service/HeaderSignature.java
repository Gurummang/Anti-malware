package com.GASB.anti_malware.service;

import lombok.Getter;

@Getter
public enum HeaderSignature {
    // Image files
    JPG("jpg", "FFD8", 4),
    PNG("png", "89504E47", 8),
    GIF("gif", "47494638", 6),
    BMP("bmp", "424D", 2),
    TIFF("tiff", "49492A00", 4),
    SVG("svg", "3C73", 4),

    // Document files
    PDF("pdf", "25504446", 4),
    DOC("doc", "D0CF11E0", 8),
    DOCX("docx", "504B0304", 4),
    XLS("xls", "D0CF11E0", 8),
    XLSX("xlsx", "504B0304", 4),
    PPT("ppt", "D0CF11E0", 8),
    PPTX("pptx", "504B0304", 4),
    TXT("txt", "EFBBBF", 3),
    HTML("html", "3C21646F637479706531", 4),

    // Executable files
    EXE("exe", "4D5A", 2),
    MSI("msi", "D0CF11E0", 8),
    APK("apk", "504B0304", 4),
    JAR("jar", "504B0304", 4),

    // Compressed files
    ZIP("zip", "504B0304", 4),
    RAR("rar", "52617221", 4),
    TAR("tar", "75737461", 4),
    GZ("gz", "1F8B", 2),
    SEVEN_ZIP("7z", "377ABC", 4);

    private final String extension;
    private final String signature;
    private final int signatureLength;

    HeaderSignature(String extension, String signature, int signatureLength) {
        this.extension = extension;
        this.signature = signature;
        this.signatureLength = signatureLength;
    }

    public static String getSignatureByExtension(String extension) {
        for (HeaderSignature type : values()) {
            if (type.getExtension().equalsIgnoreCase(extension)) {
                return type.getSignature();
            }
        }
        return null;
    }

    public static int getSignatureLengthByExtension(String extension) {
        for (HeaderSignature type : values()) {
            if (type.getExtension().equalsIgnoreCase(extension)) {
                return type.getSignatureLength();
            }
        }
        return 0;
    }
}
