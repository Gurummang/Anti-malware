package com.GASB.anti_malware.service;

import com.GASB.anti_malware.model.entity.FileStatus;
import com.GASB.anti_malware.model.entity.StoredFile;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import com.GASB.anti_malware.repository.StoredFileRepository;

@Service
public class StoredFileService {

        private final StoredFileRepository storedFileRepository;

        @Autowired
        public StoredFileService(StoredFileRepository storedFileRepository) {
            this.storedFileRepository = storedFileRepository;
        }

        public StoredFile saveStoredFile(StoredFile storedFile) {
            // FileStatus 객체 생성
            FileStatus fileStatus = new FileStatus();
            fileStatus.setStoredFile(storedFile);
            storedFile.setFileStatus(fileStatus);

            return storedFileRepository.save(storedFile);
        }

        public boolean existsBySaltedHash(String saltedHash) {
            return storedFileRepository.findBySaltedHash(saltedHash).isPresent();
        }
}

